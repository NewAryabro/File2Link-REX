<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{file_name}}</title>

<link rel="stylesheet" href="https://cdn.tailwindcss.com">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

<style>
body{background:#0b0b0b;color:#fff;font-family:sans-serif}
#audioButtons button{
  padding:8px 16px;
  border-radius:20px;
  border:1px solid #444;
  background:#111;
  color:#fff;
  cursor:pointer;
  transition:.2s;
}
#audioButtons button:hover{
  background:#1f1f1f;
}
</style>
</head>

<body>

<nav class="p-4 flex justify-between items-center bg-black">
  <h1 class="text-xl font-bold">TELUGU MOVIES 999</h1>
  <a href="https://t.me/Telugu_Movies_999" class="text-blue-400">Telegram</a>
</nav>

<div class="max-w-4xl mx-auto p-4">

  <!-- VIDEO PLAYER -->
  <video id="player" controls playsinline class="w-full rounded-lg bg-black"></video>

  <!-- AUDIO BUTTONS -->
  <div id="audioButtons" class="flex flex-wrap gap-3 justify-center mt-4"></div>

  <!-- FILE NAME -->
  <div class="mt-4 text-center text-gray-400">
    <b>File :</b> {{file_name}}
  </div>

  <!-- DOWNLOAD + PLAY OPTIONS -->
  <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mt-6 text-sm">

    <button onclick="download()" class="border p-3 rounded bg-green-600 hover:bg-green-700">
      â¬‡ Download
    </button>

    <button onclick="vlc()" class="border p-3 rounded">VLC Player</button>
    <button onclick="mx()" class="border p-3 rounded">MX Player</button>
    <button onclick="km()" class="border p-3 rounded">KM Player</button>
    <button onclick="playit()" class="border p-3 rounded">PLAYit</button>
    <button onclick="copyLink()" class="border p-3 rounded">Copy Link</button>

  </div>

</div>

<footer class="text-center text-gray-500 mt-10 p-4 text-sm">
  Designed by <b>Arya</b>
</footer>

<!-- HLS -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const video = document.getElementById("player");
  const audioBox = document.getElementById("audioButtons");
  const source = "{{file_url}}"; // MUST be master.m3u8

  if (Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(source);
    hls.attachMedia(video);

    hls.on(Hls.Events.MANIFEST_PARSED, () => {
      audioBox.innerHTML = "";

      if (hls.audioTracks.length === 0) {
        audioBox.innerHTML = "<span class='text-gray-400'>No audio tracks</span>";
        return;
      }

      hls.audioTracks.forEach((track, i) => {
        const btn = document.createElement("button");
        btn.innerText = track.name || track.lang || `Audio ${i+1}`;
        btn.onclick = () => hls.audioTrack = i;
        audioBox.appendChild(btn);
      });
    });

  } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
    video.src = source;
  } else {
    audioBox.innerHTML = "<span class='text-red-500'>HLS not supported</span>";
  }
});

/* External players */
function vlc(){location.href="vlc://"+location.href}
function mx(){location.href="intent:"+location.href+"#Intent;package=com.mxtech.videoplayer.ad;end"}
function km(){location.href="intent:"+location.href+"#Intent;package=com.kmplayer;end"}
function playit(){location.href="intent:"+location.href+"#Intent;package=com.playit.videoplayer;end"}
function download(){window.open("{{file_url}}","_blank")}
function copyLink(){
  navigator.clipboard.writeText("{{file_url}}");
  alert("Link copied!");
}
</script>

</body>
</html>
